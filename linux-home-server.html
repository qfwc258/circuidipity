<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
        <title>Circuidipity | Make an old netbook or laptop into a Linux home server</title>
        <meta http-equiv="content-type" content="text/html"; charset="utf-8" />
        <meta http-equiv="pragma" content="no-cache" />
        <meta name="author" content="Daniel Wayne Armstrong" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/main.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/pygment.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/font.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/images/icons/font-awesome/css/font-awesome.min.css">
        <link rel="icon" href="http://www.circuidipity.com/theme/images/favicon.ico" type="image/x-icon" />
</head>

<body>
        <!-- content -->

<!-- breadcrumb trail -->
<div id="breadcrumb">
    <p><a href="/"><i class="fa fa-rocket"></i> Howdy!</a> &nbsp;<i class="fa fa-arrow-right"></i>&nbsp;
    <a href="archives.html">Archives</a> &nbsp;<i class="fa fa-arrow-right"></i>&nbsp;
    Thursday 08 December 2011</p>
</div>

<!-- article -->
<h1>Make an old netbook or laptop into a Linux home server</h1>
<div id="article">
    <p>Running your own Linux home server is a fun learning experience and offers several advantages.</p>
<p>It is cheap if you already have a spare machine. Or grab a second-hand netbook off Craigslist for &lt;$100. An old netbook or laptop - retired in favour of more current and powerful machines - can still deliver plenty of oomph for running a personal server. Netbooks are frugal with power and come equipped with their own built-in UPS/battery!</p>
<p>A more stable, well-tested Linux distribution can be installed on the server and provide ongoing services such as printing, hosting torrents or websites or backups. <a class="reference external" href="http://www.debian.org/">Debian GNU/Linux</a> has over 30,000+ packages ready to install and lots of room for customization.</p>
<p>Privacy may be important to you. Hosting your own server running your own services gives more control over your data.</p>
<p>My setup uses an Asus 900HA netbook with 1GB RAM and 320GB hard drive (replacing the original 160GB drive) running the Debian <tt class="docutils literal">stable</tt> release.</p>
<p>This is how I did it ...</p>
<div class="section" id="step-0-start">
<h2>Step 0 - Start</h2>
<p><a class="reference external" href="http://www.debian.org/distrib/">Download</a> one of the many versions of the Debian installation images. For my netbook I select <tt class="docutils literal">i386</tt> as my target architecture and I use the small <tt class="docutils literal">businesscard.iso</tt>: <a class="reference external" href="http://cdimage.debian.org/debian-cd/current/i386/bt-cd/debian-6.0.3-i386-businesscard.iso.torrent">Torrent</a> | <a class="reference external" href="http://cdimage.debian.org/debian-cd/current/i386/iso-cd/debian-6.0.3-i386-businesscard.iso">Direct download</a> .</p>
</div>
<div class="section" id="step-1-prepare-a-usb-stick">
<h2>Step 1 - Prepare a USB stick</h2>
<p>USB sticks are my Linux install media of choice because I have configured several devices like this Asus netbook that do not include an optical drive. Plug the USB stick into your Linux host machine and leave the stick unmounted. Run the <tt class="docutils literal">dmesg</tt> command and note the USB device ID (<tt class="docutils literal">sdb</tt>, <tt class="docutils literal">sdc</tt>, ...).</p>
<div class="warning">
<p class="first admonition-title">Warning</p>
<p class="last">Make sure to record the correct USB device ID. The following procedure <strong>wipes out</strong> all data on the USB stick. On my system the device shows up as <em>sdb</em> but it will possibly be different on your system.</p>
</div>
<p>Copy the iso to the USB stick ...</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo cat debian-6.0.3-i386-businesscard.iso &gt; /dev/sdX
<span class="nv">$ </span>sudo sync
</pre></div>
</div>
<div class="section" id="step-2-debian-installer">
<h2>Step 2 - Debian installer</h2>
<img alt="Debian installer" src="images/debian-installer.png" />
<p>Plug the freshly prepared USB stick into the target box. Power up. Either the device is pre-configured in the BIOS to recognize a USB stick as the first choice for boot or hit the device hotkey (ESC key on my netbook) to enter the boot menu. Select the USB stick and launch the Debian installer <tt class="docutils literal">Advanced Options <span class="pre">-&gt;</span> Expert install</tt>.</p>
<p>Mostly I stick with the default selections presented by the Debian installer .. with a few exceptions noted below.</p>
<div class="section" id="choose-a-mirror-of-the-debian-archive">
<h3>Choose a mirror of the Debian archive</h3>
<p>Debian's <tt class="docutils literal">businesscard</tt> installer allows a choice of Debian versions - <tt class="docutils literal">stable</tt>, <tt class="docutils literal">testing</tt>, or <tt class="docutils literal">unstable</tt>. <tt class="docutils literal">Stable</tt> is a good choice for configuring a server ...</p>
<div class="highlight"><pre>Debian version to install:
squeeze - stable
</pre></div>
</div>
<div class="section" id="configure-the-network">
<h3>Configure the network</h3>
<p>A server machine that provides services to the network needs a stable IP address so that other machines can locate and connect to its ports. Choose to configure a <em>static IP</em> ...</p>
<div class="highlight"><pre>Auto-configure network with DHCP?
&lt;No&gt;
</pre></div>
</div>
<div class="section" id="partition-disks">
<h3>Partition disks</h3>
<p>Select the <tt class="docutils literal">Manual</tt> option to partition the drive. For a home server layout - space permitting - my chosen partition layout is:</p>
<div class="highlight"><pre>sda1 - 10GB - root partition - filesystem: ext4, noatime
sda2 - 1GB - swap partition - filesystem: swap
sda3 - remaining space - home partition - filesystem: ext4, noatime, reserved blocks: 1%
</pre></div>
<p>I create a large home partition because I use the server as backup storage for my desktop home partition ... and placing root on a separate partition allows the flexibility of re-installing the operating system at a later date without overwriting <tt class="docutils literal">/home</tt>.</p>
</div>
<div class="section" id="install-the-base-system">
<h3>Install the base system</h3>
<p>No need to include every driver under the sun. Just let the system load what is needed ...</p>
<div class="highlight"><pre>Drivers to include in the initrd:
targeted: only include drivers needed <span class="k">for </span>this system
</pre></div>
</div>
<div class="section" id="software-selection">
<h3>Software selection</h3>
<p>A lean, mean server machine starts as a <em>minimal</em> machine. <em>Un-select</em> all the software choices <em>except</em> for the standard system utilities ...</p>
<pre class="code bash literal-block">
Choose software to install:
<span class="o">[</span>*<span class="o">]</span> Standard system utilities
</pre>
<p>Finish setting up a lightweight base Debian installation. Reboot.</p>
</div>
</div>
<div class="section" id="step-3-configure">
<h2>Step 3 - Configure</h2>
<div class="section" id="fix-time-if-necessary">
<h3>Fix time (if necessary)</h3>
<div class="highlight"><pre><span class="c"># tzconfig</span>
<span class="c"># date MMDDHHmmCCYY</span>
<span class="c"># hwclock --utc</span>
<span class="c"># hwclock --systohc</span>
</pre></div>
</div>
<div class="section" id="additional-packages">
<h3>Additional packages</h3>
<pre class="code bash literal-block">
<span class="c"># apt-get install htop rsync sudo sysv-rc-conf tmux vrms</span>
</pre>
<p><a class="reference external" href="http://tmux.sourceforge.net/">Tmux</a> is a ...</p>
<blockquote>
terminal multiplexer: it enables a number of terminals (or windows), each running a separate program, to be created, accessed, and controlled from a single screen ... [then] detached from a screen and continue running in the background, then later reattached.&quot;* I love this program. Massive usefulness on a single remote connection to a server.</blockquote>
<div class="warning">
<p class="first admonition-title">Warning</p>
<p class="last">Place your netbook or laptop with the lid open (many laptops radiate heat through the keyboard) in a well-ventilated location to prevent overheating and minimize wear-and-tear. My netbook sits on an elevated metal grate that leaves the bottom vents unblocked.</p>
</div>
</div>
</div>
<div class="section" id="step-4-services">
<h2>Step 4 - Services</h2>
<p>What can you do with a Linux home server? Here are some ideas ...</p>
<div class="section" id="ssh">
<h3>SSH</h3>
<p>Install and configure SSH to allow remote login and management of your home server.</p>
<p><em>On the client</em></p>
<p>Install an SSH client and configure SSH <em>public key authentication</em> ...</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo apt-get install openssh-client ssh-askpass keychain rsync
</pre></div>
<p>Generate an RSA user-key pair ...</p>
<div class="highlight"><pre><span class="nv">$ </span>mkdir ~/.ssh
<span class="nv">$ </span><span class="nb">cd</span> ~/.ssh
<span class="nv">$ </span>ssh-keygen -v -t rsa -b 2048 -C USERNAME@HOSTNAME
</pre></div>
<p>Transfer the newly-generated public-key to your new home server. <em>Keychain</em> is a front-end to <tt class="docutils literal"><span class="pre">ssh-add</span></tt> that exists through an entire uptime across all sessions. To source ssh-keychain at startup edit <tt class="docutils literal"><span class="pre">~/.bashrc</span></tt> ...</p>
<div class="highlight"><pre>keychain ~/.ssh/id_rsa
. ~/.keychain/<span class="nv">$HOSTNAME</span>-sh
</pre></div>
<p><em>On the server</em></p>
<p>Install the SSH server package <tt class="docutils literal">sudo <span class="pre">apt-get</span> install <span class="pre">openssh-server</span></tt>.</p>
<p>Restrict SSH login access to certain users by editing <tt class="docutils literal">/etc/ssh/sshd_config</tt> ...</p>
<div class="highlight"><pre>PermitRootLogin no

<span class="c"># permit only specified users ssh access</span>
AllowUsers yourUsername
</pre></div>
<p>Restart your SSH server after modifying and saving the configuration <tt class="docutils literal">sudo /etc/init.d/ssh restart</tt>.
{% endhighlight %}</p>
<p>Copy that newly-generated RSA public-key from your client machine into your user account on the server ...</p>
<div class="highlight"><pre><span class="nv">$ </span>mkdir ~/.ssh
<span class="nv">$ </span>touch ~/.ssh/authorized_keys
<span class="nv">$ </span>cat id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
</pre></div>
<p>Logout and try logging back in to the server from a remote client machine. Once SSH is properly configured all further management of the server can be performed from the client.</p>
<p>The netbook's LCD display is no longer needed. Save power by turning off the display backlight using <tt class="docutils literal">vbetool</tt> ...</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo apt-get install vbetool
<span class="nv">$ </span>vbetool dpms off
</pre></div>
</div>
<div class="section" id="backup">
<h3>Backup</h3>
<p>I use <tt class="docutils literal">rsync</tt> to manually backup my main laptop's home partition to a designated folder on the netbook server. Scheduled backups can be configured on client machines by installing <tt class="docutils literal">anacron</tt>.</p>
</div>
<div class="section" id="web">
<h3>Web</h3>
<p>Host <a class="reference external" href="http://www.circuidipity.com/hosting-multiple-domains-from-one-ip-address-using-apache.html">multiple domains from one IP address</a>. Suitable for light traffic.</p>
<p>Bandwidth available for a home server can be limiting factor. Upload speeds provided by ISPs can be much slower than download speeds. Most things one might want to host on a personal home server can function just fine with this constraint ... but anything beyond light webhosting can quickly run into bandwidth and scalability issues.</p>
<p>After experimenting a bit I ended up moving the handwritten html pages, images, and bits of this website hosted on my netbook server to <a class="reference external" href="http://www.circuidipity.com/host-website-on-amazon-s3.html">Amazon S3</a> .</p>
</div>
<div class="section" id="id1">
<h3>Torrent</h3>
<p><a class="reference external" href="http://libtorrent.rakshasa.no/">Rtorrent</a> is a console bittorrent application that can be left running inside a detached session of tmux <tt class="docutils literal">sudo <span class="pre">apt-get</span> install rtorrent</tt>.</p>
</div>
<div class="section" id="extras">
<h3>Extras</h3>
<p><a class="reference external" href="http://freedomboxfoundation.org/">FreedomBox</a> is a Debian-sponsored project that promotes using free software deployed on personal home servers to allow users greater control over their personal information. A list of proprietary cloud services and their <a class="reference external" href="http://wiki.debian.org/FreedomBox/LeavingTheCloud">free software alternatives</a> .</p>
<p>A personal home server is a great start towards making <em>personal cloud computing</em>. Absorbing the FreedomBox documentation, presentations, and mailing list sparks many ideas that I would like to try. My little netbook has been given a new lease on life!</p>
</div>
</div>

    <p class="articletags"><i class="fa fa-coffee"></i> More         &#8226; <a class="tag" href="http://www.circuidipity.com/tag-network.html">network</a>
        &#8226; <a class="tag" href="http://www.circuidipity.com/tag-debian.html">debian</a>
        &#8226; <a class="tag" href="http://www.circuidipity.com/tag-linux.html">linux</a>
</p>
</div>

<!-- Nav links to previous|next article -->
<div id="navmenu">
    <hr />
    <p class="prevpost"><i class="fa fa-arrow-left"></i> Older<br />
        <a href="http://www.circuidipity.com/host-website-on-amazon-s3.html">Tie a balloon on your website and head for the clouds of Amazon</a></p>
    <p class="nextpost">Newer <i class="fa fa-arrow-right"></i><br />
        <a href="http://www.circuidipity.com/encrypt-external-drive.html">Configure an encrypted external hard drive in Linux</a></p>
</div>


        <!-- footer -->
<div id="footer">
    <img class="imgfooter" src="./theme/images/footerbar.png" />
    <p class="contentinfo">
    <a href="/colophon.html">Colophon</a>
    <a href="/tags.html">Tags</a>
    <a href="/"><i class="fa fa-rocket"></i> Home</a><br />
    <span class="noWrap">Copyright &#169; 2014</span> and
    <a class="invisibleLink" rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
    <img alt="Creative Commons BY-NC-SA License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    by <span class="noWrap"><a rel="author" href="/">Daniel Wayne Armstrong</a></span>&nbsp;
    <span class="noWrap"><i class="fa fa-globe"></i> Find me at <span class="whoa">daniel at circuidipity dot com</span></span></p>
</div></body>
</html>