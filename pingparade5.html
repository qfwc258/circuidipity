<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
        <title>Circuidipity | Remote control a Linux desktop using VNC</title>
        <meta http-equiv="content-type" content="text/html"; charset="utf-8" />
        <meta http-equiv="pragma" content="no-cache" />
        <meta name="author" content="Daniel Wayne Armstrong" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/main.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/pygment.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/font.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/images/icons/font-awesome/css/font-awesome.min.css">
        <link rel="icon" href="http://www.circuidipity.com/theme/images/favicon.ico" type="image/x-icon" />
</head>

<body>
        <!-- content -->

<!-- breadcrumb trail -->
<div id="breadcrumb">
    <p><a href="/"><i class="fa fa-rocket"></i> Howdy!</a> &nbsp;<i class="fa fa-arrow-right"></i>&nbsp;
    <a href="archives.html">Archives</a> &nbsp;<i class="fa fa-arrow-right"></i>&nbsp;
    Friday 03 October 2014</p>
</div>

<!-- article -->
<h1>Remote control a Linux desktop using VNC</h1>
    <p class="modified"><i class="fa fa-wrench"></i>&nbsp; Last modified on Monday 08 December 2014</p>
<div id="article">
    <p><a class="reference external" href="http://www.raspberrypi.org/">Raspberry Pi</a> is a less-than-$50 credit card sized computer that delivers all the power and flexibility of Linux, tools to start programming, and the opportunity to <a class="reference external" href="https://learn.adafruit.com/category/raspberry-pi">explore electronics</a> courtesy of the onboard GPIO pins. There is an active community of Pi enthusiasts and plenty of resources to <a class="reference external" href="http://www.raspberrypi.org/help/">help you get started</a>. I think this plucky little device has real potential as a <a class="reference external" href="http://www.circuidipity.com/home-server-hacks.html">home server</a>!</p>
<p>One of the features I really like about the Pi is that the operating system runs off an SD card. Protecting the device's firmware from being mucked up makes it very easy to experiment with different Linux releases and configurations without any fear of bricking the device. I currently run <a class="reference external" href="http://www.raspbian.org/">Raspbian Linux</a> - the default recommendation - on a SanDisk 32GB microSD with adapter but there is an active and growing <a class="reference external" href="http://elinux.org/RPi_Distributions#Available_Distributions">list of alternatives</a>.</p>
<p>The Pi has connectors for attaching an ethernet cable, USB peripherals such as keyboards and mice, and a monitor or TV permitting the device to serve as a complete standalone desktop computer. An alternative to dedicating input devices and a display to the Pi is to access the device via another computer using <strong>Virtual Networking Computing</strong>. VNC allows remote control of the Pi by transmitting all the display, keyboard, and mouse events to another computer.</p>
<div class="section" id="to-configure-a-vnc-server-and-client">
<h2>To configure a VNC server and client:</h2>
<div class="section" id="server">
<h3>0. Server</h3>
<p>VNC enables a connection to a remote device display using two different methods: control an <strong>existing</strong> remote desktop attached to a physical display on a device running a VNC server (example: <strong>x11vnc</strong>); use a VNC server on the remote device to create a <strong>new</strong> desktop (example: <a class="reference external" href="http://www.tightvnc.com/">tightvnc</a>) for display on the VNC client device. This second option is what I configure to enable running the Pi as a <strong>headless</strong> device (no attached display or peripherals).</p>
<p>Temporary access to a display and USB input devices makes the inital configuration of the Pi and VNC an easier task. The alternative is connecting to the Pi using <a class="reference external" href="http://www.raspberrypi.org/documentation/remote-access/ssh/">SSH</a>.</p>
<p>Open or access a console on the Pi and install <tt class="docutils literal">tightvncserver</tt>:</p>
<div class="highlight"><pre>$ sudo apt-get update
$ sudo apt-get install tightvncserver
</pre></div>
<p>The first time the VNC server is launched it will prompt the user to create a password to permit access to the desktop:</p>
<div class="highlight"><pre>$ vncserver
You will require a password to access your desktops.

Password:
Warning: password truncated to the length of 8.
Verify:
Would you like to enter a view-only password <span class="o">(</span>y/n<span class="o">)</span>? n
xauth:  file /home/USERNAME/.Xauthority does not exist

New <span class="s1">&#39;X&#39;</span> desktop is HOSTNAME:1

Creating default startup script /home/USERNAME/.vnc/xstartup
Starting applications specified in /home/USRNAME/.vnc/xstartup
Log file is /home/USERNAME/.vnc/HOSTNAME:1.log
</pre></div>
<p>Default port on which vncserver runs is <tt class="docutils literal">:1</tt> which corresponds to the TCP port on which the server is running (5900+n = port number)... therefore the first instance is running on <strong>5901</strong>. Running vncserver a second time will create a second instance running on the next free port, i.e <tt class="docutils literal">:2</tt> or 5902.</p>
</div>
<div class="section" id="client">
<h3>1. Client</h3>
<p>Install a VNC client to connect with the newly-accessible remote Pi (example: <a class="reference external" href="http://www.tightvnc.com/">xtightvncviewer</a> is available for multiple platforms). On my Debian-powered laptop I install the <a class="reference external" href="http://www.karlrunge.com/x11vnc/ssvnc.html">ssvnc</a> (Unix only) client:</p>
<div class="highlight"><pre>$ sudo apt-get update
$ sudo apt-get install ssvnc
</pre></div>
<p>Start the client and connect to the Pi by supplying its <tt class="docutils literal">ADDRESS:VNC_DESKTOP</tt> and the VNC desktop password:</p>
<img alt="SSVNC" class="align-center" src="images/pingparade5-ssvnc.png" style="width: 500px; height: 154px;" />
<p>... and use it with the <tt class="docutils literal">ssh</tt> option since I already run <em>openssh-server</em> on the Pi and have it setup for <a class="reference external" href="http://www.circuidipity.com/pingparade2.html">ssh key authentication</a>.</p>
<img alt="VNC" class="align-center" src="images/pingparade5-vnc.png" style="width: 800px; height: 503px;" />
<p>When finished with the session just close the VNC client window and use the <tt class="docutils literal"><span class="pre">-kill</span></tt> switch on the Pi to shut down the VNC server:</p>
<div class="highlight"><pre>$ vncserver -kill :1
</pre></div>
</div>
<div class="section" id="optimize">
<h3>2. Optimize</h3>
<p>On the Pi create <tt class="docutils literal">myVNCserver</tt> with desired vncserver settings and place in <tt class="docutils literal">~/bin</tt>:</p>
<div class="highlight"><pre><span class="ch">#!/bin/sh</span>
vncserver -geometry 1800x1000 -depth <span class="m">24</span> -dpi 96
</pre></div>
<p>Note that <tt class="docutils literal"><span class="pre">-geometry</span></tt> can be set to whatever is desired</p>
<p>With this setup VNC can be started and halted on demand. To have VNC auto-start at boot consult the <a class="reference external" href="http://www.raspberrypi.org/documentation/remote-access/vnc/">Pi documentation</a> for a sample <tt class="docutils literal">/etc/init.d</tt> script. Since I plan to run my Pi as a headless server and rarely access the desktop I will just start VNC when I need it.</p>
<p>VNC does not use the Pi graphics processor and its memory allocation can be altered to <a class="reference external" href="http://www.circuidipity.com/pi-memory-split.html">assign more RAM to the CPU</a> for running applications.</p>
<p>The desktop that vncserver puts up is controlled by <tt class="docutils literal"><span class="pre">~/.vnc/xstartup</span></tt>. To load the lightweight <strong>Openbox</strong> window manager as an alternative to the default LXDE desktop environment, comment out the <tt class="docutils literal">/etc/X11/Xsession</tt> line and replace with:</p>
<div class="highlight"><pre><span class="nb">exec</span> ck-launch-session openbox-session
</pre></div>
</div>
<div class="section" id="helpful-resources">
<h3>3. Helpful Resources</h3>
<ul class="simple">
<li><a class="reference external" href="http://www.raspberrypi.org/documentation/remote-access/vnc/">Raspberry Pi VNC</a></li>
<li><a class="reference external" href="http://www.raspberrypi.org/documentation/remote-access/vnc/linux.md">Connecting to a Pi over VNC using Linux</a></li>
<li><a class="reference external" href="https://wiki.archlinux.org/index.php/Vncserver">Vncserver on the Arch Wiki</a></li>
</ul>
<p>Happy hacking!</p>
</div>
</div>

    <p class="articletags"><i class="fa fa-coffee"></i> More         &#8226; <a class="tag" href="http://www.circuidipity.com/tag-network.html">network</a>
        &#8226; <a class="tag" href="http://www.circuidipity.com/tag-raspberry-pi.html">raspberry pi</a>
        &#8226; <a class="tag" href="http://www.circuidipity.com/tag-raspbian.html">raspbian</a>
        &#8226; <a class="tag" href="http://www.circuidipity.com/tag-linux.html">linux</a>
</p>
</div>

<!-- Nav links to previous|next article -->
<div id="navmenu">
    <hr />
    <p class="prevpost"><i class="fa fa-arrow-left"></i> Older<br />
        <a href="http://www.circuidipity.com/20141001.html">Static leases</a></p>
    <p class="nextpost">Newer <i class="fa fa-arrow-right"></i><br />
        <a href="http://www.circuidipity.com/20141006.html">Port forwarding</a></p>
</div>


        <!-- footer -->
<div id="footer">
    <img class="imgfooter" src="./theme/images/footerbar.png" />
    <p class="contentinfo">
    <span class="noWrap">
        Copyright &#169; 2015 and
        <a rel="license" class="ccLicense" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA License</a> by
        <a rel="author" class="authorID" href="/">Daniel Wayne Armstrong</a>
    </span>
    <span class="noWrap">
        <i class="fa fa-globe"></i>
        Find me at <span class="whoa">daniel at circuidipity dot com</span>
    </span>
    <br />
    Don't miss a thing... updates by
    <a href="feed.xml">RSS</a> and
    <a class="subTweat" href="https://twitter.com/circuidipity">Twitter</a>
    </p>
</div></body>
</html>