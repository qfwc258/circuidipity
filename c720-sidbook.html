<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
        <title>Circuidipity | From Chromebook to Sidbook</title>
        <meta http-equiv="content-type" content="text/html"; charset="utf-8" />
        <meta http-equiv="pragma" content="no-cache" />
        <meta name="author" content="Daniel Wayne Armstrong" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/main.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/pygment.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/font.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/images/icons/font-awesome/css/font-awesome.min.css">
        <link rel="icon" href="http://www.circuidipity.com/theme/images/favicon.ico" type="image/x-icon" />
</head>

<body>
        <!-- content -->

<!-- breadcrumb trail -->
<div id="breadcrumb">
    <p><a href="/"><i class="fa fa-rocket"></i> Howdy!</a> &nbsp;<i class="fa fa-arrow-right"></i>&nbsp;
    <a href="archives.html">Archives</a> &nbsp;<i class="fa fa-arrow-right"></i>&nbsp;
    Friday 09 May 2014</p>
</div>

<!-- article -->
<h1>From Chromebook to Sidbook</h1>
<div id="article">
    <p>A guide for replacing Chrome OS with <strong>Debian &quot;Sid&quot; Unstable</strong> on the <strong>Acer C720 Chromebook</strong>.</p>
<img alt="Debianized Acer C720" class="align-right" src="images/sidbook.png" style="width: 300px; height: 161px;" />
<p>Running a full-featured Linux on this little laptop is a delight: lightweight, several hours battery life, inexpensive, and snappy using my preferred window manager (<a class="reference external" href="http://openbox.org/">Openbox</a>).</p>
<p>There are a few different configurations of this device... mine is the <a class="reference external" href="http://us.acer.com/ac/en/US/content/model-datasheet/NX.SHEAA.002">C720-2848</a> non-touchscreen model with 2GB RAM and 16GB SSD.</p>
<div class="section" id="step-0-recovery-image">
<h2>Step 0 - Recovery Image</h2>
<p>Create a recovery image of Chrome OS in case you need to restore the Chromebook to its default configuration. This will require a spare USB stick of 4GB or better...</p>
<ul class="simple">
<li>Log into the Chromebook and let it auto update, as there sometimes are firmware updates... check the updating status in the browser at <tt class="docutils literal"><span class="pre">chrome://help</span></tt></li>
<li>Insert the USB stick, enter <tt class="docutils literal"><span class="pre">chrome://imageburner</span></tt> and follow the directions to generate a recovery image</li>
</ul>
<p>Source: <a class="reference external" href="https://support.google.com/chromebook/answer/1080595?hl=en">Create a Chromebook recovery image</a></p>
</div>
<div class="section" id="step-1-debian-installer">
<h2>Step 1 - Debian Installer</h2>
<p>I use <a class="reference external" href="http://grml.org/">GRML 2014.03</a> installed on a USB stick as my Debian install media.</p>
<p>Sources: Creating a <a class="reference external" href="http://www.circuidipity.com/multi-boot-usb.html">USB stick with multiple Linux installers</a> and <a class="reference external" href="http://www.circuidipity.com/grml-debootstrap.html">installing Debian using grml-debootstrap</a></p>
</div>
<div class="section" id="step-2-developer-mode">
<h2>Step 2 - Developer Mode</h2>
<p>Before booting the Debian installer the Chromebook needs to be put into developer mode...</p>
<ul class="simple">
<li>With the Chromebook off... Hold down <tt class="docutils literal"><span class="pre">ESC-F3</span></tt> (Refresh) keys and power on the device</li>
<li>Invoke Recovery, and at the Recovery screen press <tt class="docutils literal"><span class="pre">Ctrl-D</span></tt></li>
<li>Device will prompt for confirmation, press <tt class="docutils literal">ENTER</tt> and the system reboots into developer mode</li>
<li>'Scary' white boot screen appears and you need to press <tt class="docutils literal"><span class="pre">Ctrl-D</span></tt> to continue boot</li>
</ul>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">Switching between developer and normal (non-developer) modes will remove user accounts and their associated information from your Chromebook.</p>
</div>
</div>
<div class="section" id="step-3-usb-boot-and-legacy-bios">
<h2>Step 3 - USB Boot and Legacy BIOS</h2>
<p>Open up a shell in Chrome OS by pressing <tt class="docutils literal"><span class="pre">Ctrl-Alt-T</span></tt> and enter <tt class="docutils literal">shell</tt>.</p>
<p>Enable <tt class="docutils literal">dev_boot_usb</tt> and <tt class="docutils literal">dev_boot_legacy</tt> ...</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo crossystem <span class="nv">dev_boot_usb</span><span class="o">=</span>1
<span class="nv">$ </span>sudo <span class="nv">dev_boot_legacy</span><span class="o">=</span>1
</pre></div>
<p>Connect the USB install stick, reboot the Chromebook and press <tt class="docutils literal"><span class="pre">CTRL-L</span></tt> at the white splash screen to enter legacy boot mode.</p>
<p>Source: <a class="reference external" href="http://www.chromium.org/chromium-os">Chromium OS</a> developer information for the <a class="reference external" href="http://www.chromium.org/chromium-os/developer-information-for-chrome-os-devices/acer-c720-chromebook">Acer C720 Chromebook</a></p>
</div>
<div class="section" id="step-4-install-debian">
<h2>Step 4 - Install Debian</h2>
<p>My <a class="reference external" href="http://www.circuidipity.com/grml-debootstrap.html">grml-debootstrap instructions</a> for installing Debian Wheezy, configuring TRIM support for the SSD, and my <a class="reference external" href="https://github.com/vonbrownie/linux-post-install/blob/master/debian_post_install">post-install script</a> for upgrading and configuring Debian's sid/unstable branch.</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">After Debian is successfully installed the white boot screen will continue to appear at boot time. Keep pressing <tt class="docutils literal"><span class="pre">CTRL-L</span></tt> to fire up GRUB... <strong>DO NOT</strong> follow the suggestion to press spacebar and proceed, or <a class="reference external" href="http://www.reddit.com/r/chrubuntu/comments/1v7i0i/what_will_happen_if_i_press_the_spacebar_on_the/">your system may be wiped</a>.</p>
</div>
</div>
<div class="section" id="step-5-touchpad">
<h2>Step 5 - Touchpad</h2>
<p>After installing Debian the C720 touchpad is non-functional and requires compiling new kernel modules and creating a synaptic touchpad config file...</p>
<ul class="simple">
<li>Compile new kernel modules using the <a class="reference external" href="https://github.com/vonbrownie/linux-post-install/blob/master/extra/c720/debian/sid-c720-kern-mods.sh">sid-c720-kern-mods.sh</a> script... Confirmed <strong>working</strong> in kernel <tt class="docutils literal">3.13.10</tt> and <strong>not working</strong> in <tt class="docutils literal">3.14.x</tt></li>
<li>Create touchpad config <a class="reference external" href="https://github.com/vonbrownie/linux-post-install/blob/master/extra/c720/debian/50-c720-touchpad.conf">50-c720-touchpad.conf</a> in <tt class="docutils literal">/etc/X11/xorg.conf.d</tt> ...</li>
</ul>
<div class="highlight"><pre><span class="nv">$ </span>sudo mkdir /etc/X11/xorg.conf.d
<span class="nv">$ </span>sudo cp /usr/share/X11/xorg.conf.d/50-synaptics.conf /etc/X11/xorg.conf.d/50-c720-touchpad.conf
</pre></div>
<p>Modify this file to adjust timeouts, add tap-mouse actions (2-finger tap = right-click, 3-finger tap = middle-click), and 2-finger scrolling.</p>
<p>Sources: <a class="reference external" href="https://wiki.archlinux.org/index.php/Touchpad_Synaptics">Touchpad Synaptics</a> and <a class="reference external" href="https://wiki.archlinux.org/index.php/Acer_C720_Chromebook#configuration">C720 configuration</a> on the Arch Wiki</p>
</div>
<div class="section" id="step-6-suspend">
<h2>Step 6 - Suspend</h2>
<p>Enable suspend|resume under <strong>systemd</strong> (for sysv-init see <em>Helpful Resources</em> at bottom)...</p>
<ul class="simple">
<li>Create <a class="reference external" href="https://github.com/vonbrownie/linux-post-install/blob/master/extra/c720/debian/cros-sound-suspend.sh">cros-sound-suspend.sh</a> (make it executable) in <tt class="docutils literal"><span class="pre">/lib/systemd/system-sleep</span></tt> and...</li>
<li>... <a class="reference external" href="https://github.com/vonbrownie/linux-post-install/blob/master/extra/c720/debian/cros-acpi-wakeup.conf">cros-acpi-wakeup.conf</a> in <tt class="docutils literal">/etc/tmpfiles.d</tt> to restore sound and touchpad after suspend</li>
<li>Configure <tt class="docutils literal">GRUB_CMDLINE_LINUX_DEFAULT</tt> setting in <tt class="docutils literal">/etc/default/grub</tt>...</li>
</ul>
<div class="highlight"><pre><span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">&quot;quiet splash add_efi_memmap boot=local noresume noswap i915.modeset=1 tpm_tis.force=1 tpm_tis.interrupts=0 nmi_watchdog=panic,lapic&quot;</span>
</pre></div>
<p>... and update the grub config...</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo update-grub
</pre></div>
<p>Sources: <a class="reference external" href="https://plus.google.com/+PedroLarroy/posts/6CgQypQukMa">Chrubuntu resume fix</a> on Google+, <a class="reference external" href="https://bbs.archlinux.org/viewtopic.php?pid=1364521#p1364521">Acer C720 thread</a> in Arch Forums, and <a class="reference external" href="https://wiki.archlinux.org/index.php/Allow_users_to_shutdown">systemctl user controls</a></p>
</div>
<div class="section" id="step-7-keyboard-shortcuts">
<h2>Step 7 - Keyboard Shortcuts</h2>
<p>The top row on the keyboard with the shortcut icons (brightness, volume, etc.) identify in Linux as the <tt class="docutils literal"><span class="pre">F1-F10</span></tt> keys and the Search key (in the <tt class="docutils literal">CapsLk</tt> position) acts as the <tt class="docutils literal">Super</tt> (Windows) modifier key.</p>
<p>Create keyboard shortcuts in Openbox to modify the sound, brightness, and page movement settings by first installing...</p>
<ul class="simple">
<li>amixer - command line mixer</li>
<li>xbacklight - set backlight level using RandR</li>
<li>xdotool - simulate keyboard/mouse input</li>
</ul>
<div class="highlight"><pre><span class="nv">$ </span>sudo apt-get install alsa-utils xbacklight xdotool
</pre></div>
<p>... and creating keybindings in <tt class="docutils literal"><span class="pre">$HOME/.config/openbox/rc.xml</span></tt> ...</p>
<div class="section" id="sound">
<h3>Sound</h3>
<div class="highlight"><pre>&lt;!-- Keybindings <span class="k">for </span>Acer C720 volume keys: mute/down/up --&gt;
&lt;keybind <span class="nv">key</span><span class="o">=</span><span class="s2">&quot;W-F8&quot;</span>&gt;
    &lt;action <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Execute&quot;</span>&gt;
        &lt;<span class="nb">command</span>&gt;amixer -q -D pulse <span class="nb">set </span>Master toggle&lt;/command&gt;
    &lt;/action&gt;
&lt;/keybind&gt;
&lt;keybind <span class="nv">key</span><span class="o">=</span><span class="s2">&quot;W-F9&quot;</span>&gt;
    &lt;action <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Execute&quot;</span>&gt;
        &lt;<span class="nb">command</span>&gt;amixer -q -D pulse <span class="nb">set </span>Master 5%- unmute&lt;/command&gt;
    &lt;/action&gt;
&lt;/keybind&gt;
&lt;keybind <span class="nv">key</span><span class="o">=</span><span class="s2">&quot;W-F10&quot;</span>&gt;
    &lt;action <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Execute&quot;</span>&gt;
        &lt;<span class="nb">command</span>&gt;amixer -q -D pulse <span class="nb">set </span>Master 5%+ unmute&lt;/command&gt;
    &lt;/action&gt;
&lt;/keybind&gt;
</pre></div>
</div>
<div class="section" id="display-brightness">
<h3>Display Brightness</h3>
<div class="highlight"><pre>&lt;!-- Keybingings <span class="k">for </span>Acer C720 brightness keys: lower/raise --&gt;
&lt;keybind <span class="nv">key</span><span class="o">=</span><span class="s2">&quot;W-F6&quot;</span>&gt;
    &lt;action <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Execute&quot;</span>&gt;
        &lt;<span class="nb">command</span>&gt;xbacklight - 10&lt;/command&gt;
    &lt;/action&gt;
&lt;/keybind&gt;
&lt;keybind <span class="nv">key</span><span class="o">=</span><span class="s2">&quot;W-F7&quot;</span>&gt;
    &lt;action <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Execute&quot;</span>&gt;
        &lt;<span class="nb">command</span>&gt;xbacklight + 10&lt;/command&gt;
    &lt;/action&gt;
&lt;/keybind&gt;
</pre></div>
</div>
<div class="section" id="page-up-page-down-home-end">
<h3>Page-Up, Page-Down, Home, End</h3>
<div class="highlight"><pre> &lt;!-- Keybindings <span class="k">for </span>Page-Up, Page-Down, Home, End --&gt;
&lt;keybind <span class="nv">key</span><span class="o">=</span><span class="s2">&quot;A-Up&quot;</span>&gt;
   &lt;action <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Execute&quot;</span>&gt;
     &lt;<span class="nb">command</span>&gt;xdotool key --clearmodifiers Page_Up&lt;/command&gt;
   &lt;/action&gt;
 &lt;/keybind&gt;
 &lt;keybind <span class="nv">key</span><span class="o">=</span><span class="s2">&quot;A-Down&quot;</span>&gt;
   &lt;action <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Execute&quot;</span>&gt;
       &lt;<span class="nb">command</span>&gt;xdotool key --clearmodifiers Page_Down&lt;/command&gt;
   &lt;/action&gt;
 &lt;/keybind&gt;
 &lt;keybind <span class="nv">key</span><span class="o">=</span><span class="s2">&quot;C-A-Up&quot;</span>&gt;
   &lt;action <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Execute&quot;</span>&gt;
     &lt;<span class="nb">command</span>&gt;xdotool key --clearmodifiers Home&lt;/command&gt;
   &lt;/action&gt;
 &lt;/keybind&gt;
 &lt;keybind <span class="nv">key</span><span class="o">=</span><span class="s2">&quot;C-A-Down&quot;</span>&gt;
   &lt;action <span class="nv">name</span><span class="o">=</span><span class="s2">&quot;Execute&quot;</span>&gt;
     &lt;<span class="nb">command</span>&gt;xdotool key --clearmodifiers End&lt;/command&gt;
   &lt;/action&gt;
 &lt;/keybind&gt;
</pre></div>
</div>
</div>
<div class="section" id="power-key">
<h2>Power Key</h2>
<p>The power key ignores any configuration in the window manager and triggers poweroff without delay when pressed (easy to do by accident as its positioned next to <tt class="docutils literal">backspace</tt>).</p>
<p>If you want to disable the power key... modify <tt class="docutils literal">/etc/systemd/logind.conf</tt> and set <tt class="docutils literal">HandlePowerKey=ignore</tt>.</p>
</div>
<div class="section" id="helpful-resources">
<h2>Helpful Resources</h2>
<ul class="simple">
<li>My <a class="reference external" href="https://github.com/vonbrownie/linux-post-install/tree/master/extra/c720/debian">C720 config files</a> and the output of <a class="reference external" href="https://github.com/vonbrownie/linux-post-install/blob/master/extra/c720/debian/lshw.txt">lshw</a>, <a class="reference external" href="https://github.com/vonbrownie/linux-post-install/blob/master/extra/c720/debian/lspci.txt">lspci</a>, and <a class="reference external" href="https://github.com/vonbrownie/linux-post-install/blob/master/extra/c720/debian/lsusb.txt">lsusb</a></li>
<li><a class="reference external" href="https://github.com/liangcj/AcerC720CrunchBang">CrunchBang Linux on the C720</a></li>
<li><a class="reference external" href="https://wiki.archlinux.org/index.php/Acer_C720_Chromebook">Arch Linux wiki entry for the C720</a></li>
<li><a class="reference external" href="http://www.reddit.com/r/chrubuntu/comments/1rsxkd/list_of_fixes_for_xubuntu_1310_on_the_acer_c720/">List of fixes for Xubuntu 13.10 on the C720</a></li>
</ul>
<p>Happy hacking!</p>
</div>

    <p class="articletags"><i class="fa fa-coffee"></i> More         &#8226; <a class="tag" href="http://www.circuidipity.com/tag-chrome.html">chrome</a>
        &#8226; <a class="tag" href="http://www.circuidipity.com/tag-debian.html">debian</a>
        &#8226; <a class="tag" href="http://www.circuidipity.com/tag-linux.html">linux</a>
</p>
</div>

<!-- Nav links to previous|next article -->
<div id="navmenu">
    <hr />
    <p class="prevpost"><i class="fa fa-arrow-left"></i> Older<br />
        <a href="http://www.circuidipity.com/ubuntu1404-virtualbox.html">Ubuntu 14.04 and Virtualbox</a></p>
</div>


        <!-- footer -->
<div id="footer">
    <img class="imgfooter" src="./theme/images/footerbar.png" />
    <p class="contentinfo">
    <a href="/colophon.html">Colophon</a>
    <a href="/tags.html">Tags</a>
    <a href="/"><i class="fa fa-rocket"></i> Home</a><br />
    <span class="noWrap">Copyright &#169; 2014</span> and
    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA License</a>
    by <span class="noWrap"><a rel="author" href="/">Daniel Wayne Armstrong</a></span>&nbsp;
    <span class="noWrap"><i class="fa fa-globe"></i> Find me at <span class="whoa">daniel at circuidipity dot com</span></span></p>
</div></body>
</html>