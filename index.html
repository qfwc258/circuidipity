<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
        <title>Circuidipity | Daniel Wayne Armstrong</title>
        <meta http-equiv="content-type" content="text/html"; charset="utf-8" />
        <meta http-equiv="pragma" content="no-cache" />
        <meta name="author" content="Daniel Wayne Armstrong" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/main.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/pygment.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/font.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/images/icons/font-awesome/css/font-awesome.min.css">
        <link rel="icon" href="http://www.circuidipity.com/theme/images/favicon.ico" type="image/x-icon" />
</head>

<body>
        <!-- content -->

<!-- greeting -->
<div id="siteheader">
        <img class="whoami" src="/theme/images/whoami.png" />
    <div id="sitegreeting">
<p><span class="whoa">Howdy!</span><br />
My name is <span class="noWrap"><span class="whoa">Daniel Wayne Armstrong</span></span>.
I am learning to make <span class="noWrap">freedom-loving</span> things.</p>    </div>
<!-- menu -->
    <div id="sitemenu">
<p><a href="archives.html">Archives</a>
&nbsp;<a href="projects.html">Projects</a>
&nbsp;<a href="/colophon.html">Colophon</a>
&nbsp;<a href="feed.xml"><i class="fa fa-rss"></i></a>
&nbsp;<a href="https://twitter.com/circuidipity"><i class="fa fa-twitter"></i></a>
&nbsp;<a href="https://github.com/vonbrownie"><i class="fa fa-github-alt"></i></a></p>    </div>
</div>

<!-- latest post -->
<div id="latestpost">
        <p class="published"> Friday 27 February 2015</p>
        <h1><a href="http://www.circuidipity.com/20150227.html">A bit of unplanned Grub2 surgery</a></h1>
        <p><strong>PROBLEM:</strong> Late night experiments <a class="reference external" href="http://www.circuidipity.com/grubs.html">loading GRUB on USB sticks</a> resulted in mucking up Grub on my <strong>primary</strong> machine. After a reboot instead of a boot menu I was greeted with:</p>
<div class="highlight"><pre>grub &gt;
</pre></div>
<p>Whoops.</p>
<p>Ubuntubook is running Ubuntu 14.04 LTS with a boot partition on <tt class="docutils literal">sda1</tt>, LUKS-encrypted root on <tt class="docutils literal">sda3</tt>, and the <tt class="docutils literal">3.19.0</tt> Linux kernel. Since the boot loader hadn't fallen into rescue mode there was hope that the essential stuff was in place but for some reason the config was not being read. A quick <tt class="docutils literal">ls</tt> in the Grub shell confirmed that <tt class="docutils literal">/boot/grub/grub.cfg</tt>, kernels, initrd files were present.</p>
<p><strong>FIX:</strong> After a few tries I found the right parameters for a manual boot... specifically <tt class="docutils literal"><span class="pre">root=/dev/mapper/sda3_crypt</span></tt> NOT <tt class="docutils literal"><span class="pre">root=/dev/sda3</span></tt>:</p>
<div class="highlight"><pre>grub&gt; linux <span class="o">(</span>hd0,1<span class="o">)</span>/vmlinuz-3.19.0-031900-generic <span class="nv">root</span><span class="o">=</span>/dev/mapper/sda3_crypt ro
grub&gt; initrd <span class="o">(</span>hd0,1<span class="o">)</span>/initrd.img-3.19.0-031900-generic
grub&gt; boot
</pre></div>
<p>Boot process begins, pauses for the LUKS passphrase prompt to unlock root, and makes it to the login screen. Good stuff.</p>
<p>Examine <tt class="docutils literal">/etc/default/grub</tt> and everything looks OK. Update and <strong>reinstall grub</strong> to the MBR:</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo update-grub
<span class="nv">$ </span>sudo grub-install /dev/sda
</pre></div>
<p>Reboot and back in business!</p>
<p>Source: <a class="reference external" href="https://help.ubuntu.com/community/Grub2/Troubleshooting#Post_Boot_Follow_Up">Grub 2 Troubleshooting - Post Boot Follow Up</a></p>

        <!-- Nav links to previous|next article --> 
        <div id="navmenu">
            <hr />
            <p class="prevpost"><i class="fa fa-arrow-left"></i> Older<br />
                <a href="http://www.circuidipity.com/ubuntu-keyboard-shortcuts.html">
                Ubuntu Keyboard Shortcuts</a></p>
        </div>
</div>


        <!-- footer -->
<div id="footer">
    <img class="imgfooter" src="./theme/images/footerbar.png" />
    <p class="contentinfo">
    <span class="noWrap">
        Copyright &#169; 2015 and
        <a rel="license" class="ccLicense" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA License</a> by
        <a rel="author" class="authorID" href="/">Daniel Wayne Armstrong</a>
    </span>
    <span class="noWrap">
        <i class="fa fa-globe"></i>
        Find me at <span class="whoa">daniel at circuidipity dot com</span>
    </span>
    <br />
    Don't miss a thing... updates by
    <a href="feed.xml">RSS</a> and
    <a class="subTweat" href="https://twitter.com/circuidipity">Twitter</a>
    </p>
</div></body>
</html>