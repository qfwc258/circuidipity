<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
        <title>Circuidipity | Getting Started with BeagleBone Black</title>
        <meta http-equiv="content-type" content="text/html"; charset="utf-8" />
        <meta http-equiv="pragma" content="no-cache" />
        <meta name="author" content="Daniel Wayne Armstrong" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/main.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/pygment.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/css/font.css" type="text/css" media="all" />
        <link rel="stylesheet" href="http://www.circuidipity.com/theme/images/icons/font-awesome/css/font-awesome.min.css">
        <link rel="icon" href="http://www.circuidipity.com/theme/images/favicon.ico" type="image/x-icon" />
</head>

<body>
        <!-- content -->

<!-- breadcrumb trail -->
<div id="breadcrumb">
    <p><a href="/"><img class="minime" src="/theme/images/minime.png" alt="Mini Me" height="38" width="38" /> Howdy!</a> &nbsp;<i class="fa fa-arrow-right"></i>&nbsp;
    Monday 02 September 2013</p>
</div>

<!-- article -->
<h1>Getting Started with BeagleBone Black</h1>
<div id="article">
    <img alt="BeagleBone Black" class="align-center" src="images/bbb-details3.png" />
<p>Raspberry Pi, Arduino, OpenWRT on routers ... Happy days are here for open source on little computers! Five years ago BeagleBoard.org released its first hacker-friendly ARM-powered development board and now I am having fun exploring their brand new <em>BeagleBone Black</em> - a $45 community-supported Linux computer.</p>
<div class="section" id="step-0-out-of-box">
<h2>Step 0 - Out-of-Box</h2>
<p>The original BeagleBone - released near the end of 2011 - started with the idea of making an ARM board that would fit in a small mint tin and see how much <em>awesomesauce</em> could be packed inside! <a class="reference external" href="http://beagleboard.org/Products/BeagleBone%20Black">BeagleBone Black</a> (BBB) has the same convenient size, rounded corners, and 4 mounting holes for building projects. Onboard is a 1GHz ARMv7 processor, 512MB RAM, 2GB storage, microSD slot, a microUSB port for power and connectivity, a USB host port, microHDMI, 5V power connector, and - as I am having fun exploring - 96 header pins for interfacing BBB with external hardware. A microUSB-to-USB cable is included for connecting BBB to a host machine.</p>
<p>BeagleBone Black is completely open source ... <a class="reference external" href="http://circuitco.com/support/index.php?title=BeagleBoneBlack#Hardware_Files">hardware schematics</a> are provided (build your own!), no <em>binary blobs</em>, no <a class="reference external" href="http://www.raspberrypi.org/faqs">NDA</a> required to dive into the 4,000+ pages(!) of Texas Instruments' <a class="reference external" href="http://www.ti.com/product/am3359">AM335x processor manual</a>. BBB ships with the <em>Angstrom Linux</em> distribution pre-installed ... but using an ARMv7 processor is a big plus because alternative ARM ports of the mainstream Linux distros (such as Debian) are available for the BBB without re-compiling packages. BBB is also one of the first ARM devices to fully embrace the <a class="reference external" href="http://linuxgizmos.com/introducing-the-new-beaglebone-black-kernel">Linux Device Tree</a> and will benefit from ongoing ARM improvements in mainstream kernel development and make it easier to create expansion boards (or <em>capes</em> in BBB lingo) for the device.</p>
</div>
<div class="section" id="step-1-connect-to-host">
<h2>Step 1 - Connect to Host</h2>
<p>BeagleBone Black is designed to get the Linux user up-and-running quickly. Within a few minutes of unboxing the device I was using the provided USB cable to connect the device to my host computer (running Debian <tt class="docutils literal">sid</tt>). BBB mounts as a usb-storage device and provides a usbnet virtual-ethernet interface running a DHCP server.</p>
<p>Some post-connection HOST output of interest ...</p>
<div class="highlight"><pre><span></span>$ cat /var/log/kern.log
Sep  <span class="m">1</span> 16:58:17 kambei kernel: <span class="o">[</span>455195.036280<span class="o">]</span> usb 1-1.2: new high-speed USB device number <span class="m">20</span> using ehci-pci
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.129344<span class="o">]</span> usb 1-1.2: New USB device found, <span class="nv">idVendor</span><span class="o">=</span>1d6b, <span class="nv">idProduct</span><span class="o">=</span>0104
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.129350<span class="o">]</span> usb 1-1.2: New USB device strings: <span class="nv">Mfr</span><span class="o">=</span>2, <span class="nv">Product</span><span class="o">=</span>3, <span class="nv">SerialNumber</span><span class="o">=</span>4
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.129355<span class="o">]</span> usb 1-1.2: Product: BeagleBoneBlack
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.129358<span class="o">]</span> usb 1-1.2: Manufacturer: Circuitco
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.129361<span class="o">]</span> usb 1-1.2: SerialNumber: 5A-1713BBBK2013
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.133166<span class="o">]</span> rndis_host 1-1.2:1.0 eth1: register <span class="s1">&#39;rndis_host&#39;</span> at usb-0000:00:1a.0-1.2, RNDIS device, c8:a0:30:ac:1d:6f
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.133843<span class="o">]</span> cdc_acm 1-1.2:1.2: This device cannot <span class="k">do</span> calls on its own. It is not a modem.
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.133917<span class="o">]</span> cdc_acm 1-1.2:1.2: ttyACM0: USB ACM device
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.135249<span class="o">]</span> usb-storage 1-1.2:1.4: USB Mass Storage device detected
Sep  <span class="m">1</span> 16:58:18 kambei kernel: <span class="o">[</span>455195.135458<span class="o">]</span> scsi20 : usb-storage 1-1.2:1.4
Sep  <span class="m">1</span> 16:58:19 kambei kernel: <span class="o">[</span>455196.133604<span class="o">]</span> scsi 20:0:0:0: Direct-Access     Linux    File-CD Gadget   <span class="m">0308</span> PQ: <span class="m">0</span> ANSI: 2
Sep  <span class="m">1</span> 16:58:19 kambei kernel: <span class="o">[</span>455196.134045<span class="o">]</span> sd 20:0:0:0: Attached scsi generic sg1 <span class="nb">type</span> 0
Sep  <span class="m">1</span> 16:58:19 kambei kernel: <span class="o">[</span>455196.135313<span class="o">]</span> sd 20:0:0:0: <span class="o">[</span>sdb<span class="o">]</span> <span class="m">144522</span> 512-byte logical blocks: <span class="o">(</span>73.9 MB/70.5 MiB<span class="o">)</span>
Sep  <span class="m">1</span> 16:58:19 kambei kernel: <span class="o">[</span>455196.136080<span class="o">]</span> sd 20:0:0:0: <span class="o">[</span>sdb<span class="o">]</span> Write Protect is off
Sep  <span class="m">1</span> 16:58:19 kambei kernel: <span class="o">[</span>455196.136089<span class="o">]</span> sd 20:0:0:0: <span class="o">[</span>sdb<span class="o">]</span> Mode Sense: 0f <span class="m">00</span> <span class="m">00</span> 00
Sep  <span class="m">1</span> 16:58:19 kambei kernel: <span class="o">[</span>455196.136840<span class="o">]</span> sd 20:0:0:0: <span class="o">[</span>sdb<span class="o">]</span> Write cache: enabled, <span class="nb">read</span> cache: enabled, doesn<span class="err">&#39;</span>t support DPO or FUA
Sep  <span class="m">1</span> 16:58:19 kambei kernel: <span class="o">[</span>455196.147108<span class="o">]</span>  sdb:
Sep  <span class="m">1</span> 16:58:19 kambei kernel: <span class="o">[</span>455196.149998<span class="o">]</span> sd 20:0:0:0: <span class="o">[</span>sdb<span class="o">]</span> Attached SCSI removable disk
$ lsusb
Bus <span class="m">001</span> Device 020: ID 1d6b:0104 Linux Foundation Multifunction Composite Gadget
$ mount
/dev/sdb on /media/dwa/BEAGLEBONE <span class="nb">type</span> vfat <span class="o">(</span>rw,nosuid,nodev,relatime,uid<span class="o">=</span>1000,gid<span class="o">=</span>1000,fmask<span class="o">=</span>0022,dmask<span class="o">=</span>0077,codepage<span class="o">=</span>437,iocharset<span class="o">=</span>utf8,shortname<span class="o">=</span>mixed,showexec,utf8,flush,errors<span class="o">=</span>remount-ro,uhelper<span class="o">=</span>udisks2<span class="o">)</span>
$ ls /dev/ttyA*
crw-rw---T <span class="m">1</span> root dialout 166, <span class="m">0</span> Aug <span class="m">18</span> 13:30 /dev/ttyACM0
$ ifconfig
eth0      Link encap:Ethernet  HWaddr f0:de:f1:15:e8:51
          inet addr:192.168.1.4  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::f2de:f1ff:fe15:e851/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:22559530 errors:0 dropped:0 overruns:0 frame:0
          TX packets:21337616 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:28619436829 <span class="o">(</span>26.6 GiB<span class="o">)</span>  TX bytes:3283938274 <span class="o">(</span>3.0 GiB<span class="o">)</span>
          Interrupt:20 Memory:f2500000-f2520000

eth1      Link encap:Ethernet  HWaddr c8:a0:30:ac:1d:6f
          inet addr:192.168.7.1  Bcast:192.168.7.3  Mask:255.255.255.252
          inet6 addr: fe80::caa0:30ff:feac:1d6f/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:35 errors:0 dropped:0 overruns:0 frame:0
          TX packets:83 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:6572 <span class="o">(</span>6.4 KiB<span class="o">)</span>  TX bytes:18103 <span class="o">(</span>17.6 KiB<span class="o">)</span>
</pre></div>
<p>I use the <em>Thunar</em> file manager to browse the device and click on <tt class="docutils literal">START.htm</tt> to launch BeagleBone's <em>Getting Started</em> page in a web browser.</p>
<img alt="Thunar file manager" class="align-center" src="images/bbb-start.png" />
<p>Scroll down to <tt class="docutils literal">Step #3: Browse to your board</tt> and clicking on the address of BBB's web server <tt class="docutils literal">192.168.7.2</tt> opens the onboard documentation <tt class="docutils literal">BeagleBone 101</tt>.</p>
<img alt="Beaglebone 101" class="align-center" src="images/bbb-101.png" />
<p>Also included is a link to a self-hosted instance of the <em>Cloud9 IDE</em>  listening at <tt class="docutils literal">192.168.7.2:3000</tt> that provides a JavaScript library called <em>BoneScript</em> for hacking on the BeagleBone's hardware. Some tiny example scripts are provided to blink LEDs and whatnot ... at first glance they remind me of Arduino code but I haven't really played with this environment (or Arduino for that matter) much yet.</p>
<p><em>Network-Manager</em> auto-creates a second wired interface for the BeagleBone Black on my HOST ... allowing me to ssh into the device as <tt class="docutils literal">root&#64;192.168.7.2</tt> or <tt class="docutils literal">root&#64;beaglebone.local</tt> (Angstrom runs <em>Avahi</em> daemon by default) and no password. Will definitely need to change <strong>that</strong> ... but not before ...</p>
</div>
<div class="section" id="step-2-flashing-updated-angstrom-image">
<h2>Step 2 - Flashing updated Angstrom image</h2>
<p>Having determined the device is working - and before diving into custom configuration - its a good idea to flash an updated Angstrom image for the BeagleBone Black to the device's onboard eMMC storage. This will require a microSD (8GB+) card and a 5V power adapter.</p>
<div class="section" id="download-and-unpack-image">
<h3>Download and unpack image</h3>
<p>Angstrom image files for the BBB are labelled <a class="reference external" href="http://dominion.thruhere.net/koen/angstrom/beaglebone/">BBB-eMMC-flasher-xxxx.xx.xx.img.xz</a> ... Latest version as of 2 September is <tt class="docutils literal"><span class="pre">BBB-eMMC-flasher-2013.08.21.img.xz</span></tt>.</p>
<p>Using the above image as an example ... download the <tt class="docutils literal"><span class="pre">xz-utils</span></tt> Debian package and download and unpack the Angstrom image ...</p>
<div class="highlight"><pre><span></span>$ sudo apt-get install xz-utils
$ wget -c http://dominion.thruhere.net/koen/angstrom/beaglebone/BBB-eMMC-flasher-2013.08.21.img.xz
$ xz -d BBB-eMMC-flasher-2013.08.21.img.xz
</pre></div>
</div>
<div class="section" id="copy-image-to-microsd">
<h3>Copy image to microSD</h3>
<p><span class="warning">WARNING!</span> Be careful to note the proper <em>DeviceID</em> of your microSD card ... in my example I use <em>sdb</em> but your device will probably have a <em>different address</em>. Command <em>dd</em> will completely <strong>wipe out the contents of the card</strong>. Its not nicknamed <em>disk destroyer</em> for nothing!</p>
<p>Copy image to card using <tt class="docutils literal">dd</tt> ...</p>
<div class="highlight"><pre><span></span>$ sudo dd <span class="k">if</span><span class="o">=</span>BBB-eMMC-flasher-2013.08.21.img <span class="nv">of</span><span class="o">=</span>/dev/sdb <span class="nv">bs</span><span class="o">=</span>1M
</pre></div>
</div>
<div class="section" id="flash-the-bbb">
<h3>Flash the BBB</h3>
<p>A USB port does not supply enough power to the BBB when flashing an image to the eMMC ... the board must be connected to a 5V adapter. Luckily I was able to recycle an old Linksys power adapter that provided the necessary 5V and 2000mA and fit the power plug on the BBB.</p>
<p>With the BBB disconnected from HOST and powered off ... insert the Angstrom-prepared microSD card into BBB. Hold down the BOOT button (located above the microSD slot), connect the 5V adapter, and wait until you see the bank of 4 LEDs on the BBB all light up for a few seconds before releasing BOOT. A new image is now being flashed from card to BBB storage and will take approximately 50-60 minutes. Upon completion all 4 LEDs will be lit solid. Disconnect power, remove the microSD, then restore power and BBB will boot into the updated Angstrom.</p>
</div>
</div>
<div class="section" id="step-3-configuration">
<h2>Step 3 - Configuration</h2>
<div class="section" id="root-password">
<h3>Root password</h3>
<p>Root with no password <em>oh noooooo</em> ... set one now <tt class="docutils literal">passwd</tt>.</p>
<p>You might also want to create an unprivileged user account (I did not).</p>
</div>
<div class="section" id="configure-host-as-router">
<h3>Configure HOST as router</h3>
<p>Tip from <a class="reference external" href="http://shallowsky.com/blog/hardware/talking-to-beaglebone.html">http://shallowsky.com/blog/hardware/talking-to-beaglebone.html</a></p>
<p>When BBB is connected to my HOST via USB ... Network-Manager sets up a second wired interface <tt class="docutils literal">eth1</tt> to connect with BBB ... and BBB connects to HOST through <tt class="docutils literal">usb0</tt> ...</p>
<div class="highlight"><pre><span></span>$ ifconfig
...
usb0      Link encap:Ethernet  HWaddr BA:E1:A2:37:43:15
          inet addr:192.168.7.2  Bcast:192.168.7.3  Mask:255.255.255.252
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:7685 errors:0 dropped:0 overruns:0 frame:0
          TX packets:12461 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:888859 <span class="o">(</span>868.0 KiB<span class="o">)</span>  TX bytes:13309157 <span class="o">(</span>12.6 MiB<span class="o">)</span>
</pre></div>
<p>This arrangment is OK for getting HOST and BBB talking to each other but BBB - in lieu of an additional ethernet cable - cannot reach the net. I created a tiny script that can be run as desired to configure my Linux HOST to route internet traffic for the BBB ...</p>
<div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1"># bbbIPforward.sh -- Enable internet access for my BeagleBone Black (BBB)</span>
<span class="c1"># using my Linux HOST as a router</span>

<span class="nv">bbbAddr</span><span class="o">=</span><span class="s2">&quot;192.168.7.2&quot;</span>
<span class="nv">hostAddr</span><span class="o">=</span><span class="s2">&quot;192.168.7.1&quot;</span>

<span class="c1"># Configure IP forwarding on HOST</span>
sudo iptables -A POSTROUTING -t nat -j MASQUERADE
<span class="nb">echo</span> <span class="m">1</span> <span class="p">|</span> sudo tee /proc/sys/net/ipv4/ip_forward &gt; /dev/null

<span class="c1"># Copy ssh key to BBB for passwordless logins</span>
ssh-copy-id root@<span class="nv">$bbbAddr</span>

<span class="c1"># Configure BBB to use HOST as gateway</span>
ssh root@<span class="nv">$bbbAddr</span> <span class="s2">&quot;/sbin/route add default gw </span><span class="nv">$hostAddr</span><span class="s2">&quot;</span>

<span class="c1"># Backup and substitute BBB resolv.conf with HOST resolv.conf</span>
ssh root@<span class="nv">$bbbAddr</span> <span class="s2">&quot;mv -n /etc/resolv.conf /etc/resolv.conf.bak&quot;</span>
scp /etc/resolv.conf root@<span class="nv">$bbbAddr</span>:/etc/
</pre></div>
</div>
<div class="section" id="date-and-time">
<h3>Date and Time</h3>
<p>Tip from <a class="reference external" href="http://derekmolloy.ie/automatically-setting-the-beaglebone-black-time-using-ntp/">http://derekmolloy.ie/automatically-setting-the-beaglebone-black-time-using-ntp/</a></p>
<p>The BeagleBone Black does not include an onboard <em>Real Time Clock</em> (RTC) and thus loses its time and date setting after every power off.</p>
<p>Set the time over the internet using an ntp server by first configuring the timezone linking <tt class="docutils literal">localtime</tt> to your proper location in <tt class="docutils literal">zoneinfo</tt> (in my case <tt class="docutils literal">Toronto/New York</tt>) and then running a quick one-off command to set the proper date ...</p>
<div class="highlight"><pre><span></span><span class="c1"># ln -s /usr/share/zoneinfo/America/New_York /etc/localtime</span>
<span class="c1"># ntpdate -u pool.ntp.org</span>
</pre></div>
<p>... but the date/time will still be lost after every shutdown.</p>
<p>For a more permanent solution install <em>NTP</em> ...</p>
<div class="highlight"><pre><span></span><span class="c1"># opkg update</span>
<span class="c1"># opkg install ntp</span>
</pre></div>
<p>Find local NTP servers (Canada) and edit <tt class="docutils literal">/etc/ntp.conf</tt> ...</p>
<div class="highlight"><pre><span></span>driftfile /etc/ntp.drift
logfile /var/log/ntpd.log

<span class="c1"># NTP Servers for Canada from www.pool.ntp.org</span>
server 0.ca.pool.ntp.org
server 1.ca.pool.ntp.org
server 2.ca.pool.ntp.org
server 3.ca.pool.ntp.org

<span class="c1"># Using local hardware clock as fallback</span>
<span class="c1"># Disable this when using ntpd -q -g -x as ntpdate or it will sync to itself</span>
<span class="c1"># server 127.127.1.0</span>
<span class="c1"># fudge 127.127.1.0 stratum 14</span>

<span class="c1"># Defining a default security setting</span>
restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap
</pre></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Angstrom uses <em>systemd</em> and init.d is replaced by <em>systemctl COMMAND</em> and files are located in <em>/lib/systemd/system/NAME.service</em>.</p>
</div>
<p>Enable NTP services ...</p>
<div class="highlight"><pre><span></span><span class="c1"># systemctl enable ntpdate.service</span>
<span class="c1"># systemctl enable ntpd.service</span>
<span class="c1"># cat /lib/systemd/system/ntpd.service</span>
<span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>Network Time Service
<span class="nv">After</span><span class="o">=</span>network.target

<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">Type</span><span class="o">=</span>forking
<span class="nv">PIDFile</span><span class="o">=</span>/run/ntpd.pid
<span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/ntpd -p /run/ntpd.pid

<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
<span class="o">{</span>% endhighlight %<span class="o">}</span>
</pre></div>
<p>Modify <tt class="docutils literal">ExecStart</tt> of <tt class="docutils literal">/lib/systemd/system/ntpdate.service</tt> ....</p>
<div class="highlight"><pre><span></span><span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>Network Time Service <span class="o">(</span>one-shot ntpdate mode<span class="o">)</span>
<span class="nv">Before</span><span class="o">=</span>ntpd.service

<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">Type</span><span class="o">=</span>oneshot
<span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/ntpd -q -g -x
<span class="nv">ExecStart</span><span class="o">=</span>/sbin/hwclock --systohc
<span class="nv">RemainAfterExit</span><span class="o">=</span>yes

<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</pre></div>
<p>Save all changes, reboot the BBB while connected to the Internet, and verify the proper date and time are set with <tt class="docutils literal">timedatectl</tt> ...</p>
<div class="highlight"><pre><span></span>   <span class="c1"># timedatectl</span>
     Local time: Wed 2013-07-10 23:14:45 EDT
 Universal time: Thu 2013-07-11 03:14:45 UTC
       RTC time: Wed 2013-07-10 23:14:45
       Timezone: America/New_York <span class="o">(</span>EDT, -0400<span class="o">)</span>
       NTP enabled: no
   NTP synchronized: yes
RTC in <span class="nb">local</span> TZ: no
     DST active: yes
Last DST change: DST began at
                 Sun 2013-03-10 01:59:59 EST
                 Sun 2013-03-10 03:00:00 EDT
Next DST change: DST ends <span class="o">(</span>the clock jumps one hour backwards<span class="o">)</span> at
                 Sun 2013-11-03 01:59:59 EDT
                 Sun 2013-11-03 01:00:00 EST
</pre></div>
<p>Reference: <a class="reference external" href="http://stackoverflow.com/questions/11219832/what-is-the-best-way-to-run-ntpdate-at-reboot-only-after-network-is-ready">What is the best way to run ntpdate?</a></p>
</div>
<div class="section" id="remote-desktop">
<h3>Remote Desktop</h3>
<p>Tip from <a class="reference external" href="http://digitaldiner.blogspot.ca/2013/05/quick-hint-for-beaglebone-black-user.html">http://digitaldiner.blogspot.ca/2013/05/quick-hint-for-beaglebone-black-user.html</a></p>
<p>In lieu of a microHDMI cable for connecting an HDMI display to the BBB the device may be configured to transmit a remote desktop to HOST.</p>
<p>On BBB install the <tt class="docutils literal">x11vnc</tt> package and launch ...</p>
<div class="highlight"><pre><span></span><span class="c1"># opkg update</span>
<span class="c1"># opkg install x11vnc</span>
<span class="c1"># x11vnc -bg -o %HOME/.x11vnc.log.%VNCDISPLAY -auth /var/run/gdm/auth-for-gdm*/database -display :0  -forever</span>
</pre></div>
<p>... which provides a display available for remote viewing at address <tt class="docutils literal">192.168.7.2:5900</tt>.</p>
<p>On my HOST I install and use the <tt class="docutils literal">ssvnc</tt> viewer <tt class="docutils literal">sudo <span class="pre">apt-get</span> install ssvnc</tt>.</p>
<p>It works!</p>
<img alt="Remote desktop" class="align-center" src="images/bbb-x11vnc.png" />
<p>Reference: <a class="reference external" href="http://www.karlrunge.com/x11vnc/">http://www.karlrunge.com/x11vnc/</a></p>
</div>
</div>
<div class="section" id="step-4-issues-and-fixes">
<h2>Step 4 - Issues and Fixes</h2>
<p><em>BeagleBone Black Rev. A5A running default Angstrom Linux</em></p>
<div class="section" id="opkg-upgrade">
<h3>'opkg upgrade'</h3>
<p><em>Fix:</em> Do not run this command or else Bad Things Will Happen.</p>
</div>
<div class="section" id="no-login-screen-over-hdmi">
<h3>No login screen over HDMI</h3>
<p><em>Issue:</em> BeagleBone logo appears at boot but no login screen.</p>
<p><em>Fix:</em> Turns out that my powered USB hub - with keyboard attached - was not being detected by the BBB during boot. If the device thinks no keyboard or mouse is attached during boot it kills power to the microHDMI port and hence no display. You can &quot;wake up&quot; the display by ssh'ing into BBB and sending an <tt class="docutils literal">echo 0 &gt; /sys/class/graphics/fb0/blank</tt> command but it will still fail to detect a hot-plugged USB keyboard or mouse.</p>
<p>If I connect the keyboard (with built-in trackpoint) directly to the BBB USB port and reboot and hit SHIFT key the display springs to life and the login window appears.</p>
<p><em>Issue:</em> BeagleBone logo appears at boot but no login screen (and this time its not the keyboard).</p>
<p><em>Fix:</em> Creating a password for root causes the <em>autologin</em> task running at login screen to constantly fail (because it doesn't know the password) and buggers up the display. To disable autologin edit <tt class="docutils literal">/etc/gdm/custom.conf</tt> and modify the line <tt class="docutils literal">TimedLoginEnable</tt> from <tt class="docutils literal">true</tt> to <tt class="docutils literal">false</tt> ...</p>
<div class="highlight"><pre><span></span><span class="o">[</span>daemon<span class="o">]</span>
<span class="nv">TimedLoginEnable</span><span class="o">=</span><span class="nb">false</span>
</pre></div>
<p>... and restart GDM with the command <tt class="docutils literal">systemctl restart gdm.service</tt>.</p>
<p>Reference: <a class="reference external" href="http://circuitco.com/support/index.php?title=BeagleBoneBlack_HDMI">http://circuitco.com/support/index.php?title=BeagleBoneBlack_HDMI</a></p>
<ul class="simple">
<li><a class="reference external" href="http://bb-lcnc.blogspot.ca/2013/06/force-beaglebone-black-hdmi-resolution.html">http://bb-lcnc.blogspot.ca/2013/06/force-beaglebone-black-hdmi-resolution.html</a></li>
</ul>
</div>
<div class="section" id="hdmi-output-goes-beyond-edge-of-display">
<h3>HDMI output goes beyond edge of display</h3>
<p><em>Issue:</em> Using a microHDMI-HDMI cable to connect BBB to my 1920x1200 display produces a working 1280x720 resolution working ... but the desktop area is slightly bigger than the margins of the display.</p>
<p><em>Fix:</em> Needed to adjust settings on display ... modifying <tt class="docutils literal">Image <span class="pre">Setting-&gt;Video</span> <span class="pre">Mode-&gt;Video</span> Mode</tt> to <tt class="docutils literal">Image <span class="pre">Setting-&gt;Video</span> <span class="pre">Mode-&gt;PC</span> Mode</tt></p>
<p>Reference: <a class="reference external" href="http://groups.google.com/forum/#!msg/beagleboard/sxaSIUpiZo8/__TmDqD4aJcJ">http://groups.google.com/forum/#!msg/beagleboard/sxaSIUpiZo8/__TmDqD4aJcJ</a></p>
</div>
</div>
<div class="section" id="drm-debug">
<h2>drm.debug</h2>
<p><em>Issue:</em> A whole pile of these messages were filling dmesg ...</p>
<div class="highlight"><pre><span></span><span class="o">[</span>Mon Aug <span class="m">26</span> 03:34:00 2013<span class="o">]</span> <span class="o">[</span>drm:output_poll_execute<span class="o">]</span>, <span class="o">[</span>CONNECTOR:5:HDMI-A-1<span class="o">]</span> status updated from <span class="m">2</span> to 2
</pre></div>
<p>... repeating every few seconds.</p>
<p><em>Fix:</em> These debugging messages can safely be turned off by editing <tt class="docutils literal">uEnv.txt</tt> located on the <tt class="docutils literal">mmcblk0p1</tt> partition (<strong>not</strong> the <tt class="docutils literal">uEnv.txt</tt> found in <tt class="docutils literal">boot</tt>).</p>
<p>If that partition is not auto-mounted (mine was not) then go ahead and mount it now ...</p>
<div class="highlight"><pre><span></span><span class="c1"># mount /dev/mmcblk0p1 /media/BEAGLEBONE/</span>
</pre></div>
<p>... and edit <tt class="docutils literal">/media/BEAGLEBONE/uEnv.txt</tt> by changing the line <tt class="docutils literal">optargs=quiet drm.debug=7</tt> to simply <tt class="docutils literal">optargs=quiet</tt> ... Reboot and issue resolved.</p>
<div class="section" id="resolv-conf">
<h3>resolv.conf</h3>
<p><em>Issue:</em> Noticed an instance where after running <tt class="docutils literal">opkg update</tt> internet access was broken and I was getting a pile of <tt class="docutils literal">wget: bad address <span class="pre">'feeds.angstrom-distribution.org'</span></tt> errors ... <tt class="docutils literal">ifconfig</tt> showed I still had a good connection to LAN.</p>
<p><em>Fix:</em> Discovered that <tt class="docutils literal">resolv.conf</tt> was pointing to <tt class="docutils literal">127.0.0.1</tt>. Modified file to my router's IP address ... ran update again and everything OK.</p>
</div>
<div class="section" id="urxvt">
<h3>urxvt</h3>
<p><em>Issue:</em> Using <tt class="docutils literal">urxvt</tt> as my terminal and ssh'ing into BBB ... some commands like <tt class="docutils literal">htop</tt> will not run.</p>
<p><em>Fix:</em> Copy <tt class="docutils literal"><span class="pre">/usr/share/terminfo/r/rxvt-unicode</span></tt> from HOST to the BBB and place in <tt class="docutils literal"><span class="pre">~/.terminfo/r/rxvt-unicode</span></tt>. Same for <tt class="docutils literal"><span class="pre">rxvt-unicode-256color</span></tt>.</p>
<p>Reference: <a class="reference external" href="https://wiki.archlinux.org/index.php/Urxvt#Remote_Hosts">https://wiki.archlinux.org/index.php/Urxvt#Remote_Hosts</a></p>
</div>
<div class="section" id="ssh-session-hangs">
<h3>SSH session hangs</h3>
<p><em>Issue:</em> SSH session sometimes hangs when rebooting the BBB.</p>
<p><em>Fix:</em> Type <tt class="docutils literal">~.</tt> and it should kill the SSH session.</p>
</div>
</div>
<div class="section" id="step-5-helpful-resources">
<h2>Step 5 - Helpful Resources</h2>
<ul class="simple">
<li>Purchase a BeagleBone Black: in my hometown (Toronto) from <a class="reference external" href="http://www.creatroninc.com/">Creatron</a> or online from <a class="reference external" href="https://www.adafruit.com/category/75">Adafruit</a>, <a class="reference external" href="http://www.digikey.ca/product-detail/en/BB-BBLK-000/BB-BBLK-000-ND/3884456">Digikey</a> and others</li>
<li>BeagleBone Black <a class="reference external" href="http://circuitco.com/support/index.php?title=BeagleBoneBlack">wiki</a> and <a class="reference external" href="https://groups.google.com/forum/?fromgroups#!forum/beagleboard">forum</a> and <a class="reference external" href="https://github.com/CircuitCo/BeagleBone-Black/blob/master/BBB_SRM.pdf?raw=true">System Reference Manual</a></li>
<li>BBB on the <a class="reference external" href="http://elinux.org/BeagleBone">Embedded Linux Wiki</a> and <a class="reference external" href="http://eewiki.net/display/linuxonarm/BeagleBone+Black">eewiki</a></li>
<li><a class="reference external" href="http://learn.adafruit.com/category/beaglebone/">Hardware tutorials</a> on Adafruit</li>
<li>Excellent series of tutorials and videos by <a class="reference external" href="http://derekmolloy.ie/tag/beaglebone-black/">Derek Molloy</a> ... his tables for the BBB's <a class="reference external" href="https://github.com/derekmolloy/boneDeviceTree/blob/master/docs/BeagleboneBlackP8HeaderTable.pdf?raw=true">P8</a> and <a class="reference external" href="https://github.com/derekmolloy/boneDeviceTree/blob/master/docs/BeagleboneBlackP8HeaderTable.pdf?raw=true">P9</a> header pins are essential if you play with the hardware</li>
<li><a class="reference external" href="https://github.com/jadonk/bonescript">Bonescript</a> scripting tools</li>
<li>Angstrom Linux <a class="reference external" href="http://www.angstrom-distribution.org/repo/">package browser</a></li>
<li>BBB and the <a class="reference external" href="http://elinux.org/BeagleBone_and_the_3.8_Kernel">3.8 kernel</a> and an <a class="reference external" href="http://linuxgizmos.com/introducing-the-new-beaglebone-black-kernel/">introduction</a> from Jason Kridner, co-founder of BeagleBoard.org</li>
</ul>
</div>

    <p class="articletags"><i class="fa fa-coffee"></i> More         &#8226; <a class="tag" href="http://www.circuidipity.com/tag-beaglebone.html">beaglebone</a>
        &#8226; <a class="tag" href="http://www.circuidipity.com/tag-electronics.html">electronics</a>
        &#8226; <a class="tag" href="http://www.circuidipity.com/tag-linux.html">linux</a>
</p>
</div>

<!-- Nav links to previous|next article -->
<div id="navmenu">
    <hr />
    <p class="prevpost"><i class="fa fa-arrow-left"></i> Older<br />
        <a href="http://www.circuidipity.com/sputnik.html">It is for those in the future to envy us our Joy</a></p>
    <p class="nextpost">Newer <i class="fa fa-arrow-right"></i><br />
        <a href="http://www.circuidipity.com/bbb-led.html">BeagleBone Black: 'Say Hello to My Little LEDs'</a></p>
</div>


        <!-- footer -->
<div id="footer">
    <img class="imgfooter" src="./theme/images/footerbar.png" />
    <p class="contentinfo">
    <span class="noWrap">
        Copyright &#169; 2017 and
        <a rel="license" class="ccLicense" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA License</a> by
        <a rel="author" class="authorID" href="/">Daniel Wayne Armstrong</a>
    </span>
    <span class="noWrap">
        <i class="fa fa-globe"></i>
        Find me at <span class="whoa">daniel at circuidipity dot com</span>
    </span>
    <br />
    Don't miss a thing... updates by
    <a href="feed.xml">RSS</a> and
    <a class="subTweat" href="https://twitter.com/circuidipity">Twitter</a>
    </p>
</div></body>
</html>